[gcode_macro _CLEAN_TRAVEL_SAFETY]
gcode:
  {% set clean_vars = printer["gcode_macro _CLEAN_VARIABLES"] %}

    RESPOND TYPE=COMMAND MSG="Raising Z Axis for travel to cleaner!"
  {% if clean_vars.min_travel_to_clean_z|float <= 2 and clean_vars.min_travel_to_clean_z|float > 0.6 %}
    {% if 'quad_gantry_level' in printer %}
      {% if not printer.quad_gantry_level.applied %}
        RESPOND TYPE=error MSG="NOTE: Levelling system not applied! System override! Travelling at Z10.0 for safety."
        G0 Z10 F3600
      {% else %}
        {% if clean_vars.min_travel_to_clean_z|float <= 1.5 %}
          RESPOND TYPE=error MSG="NOTE: User defined min_travel_to_clean_z is set below 1.5mm - Warning possible bed damage may occur!"
        {% endif %}
        G0 Z{clean_vars.min_travel_to_clean_z|float} F3600
      {% endif %}

    {% elif 'z_tilt' in printer %}
      {% if not printer.z_tilt.applied %}
        RESPOND TYPE=error MSG="NOTE: Levelling system not applied! System override! Travelling at Z10.0 for safety."
        G0 Z10 F3600
      {% else %}
        {% if clean_vars.min_travel_to_clean_z|float <= 1.5 %}
          RESPOND TYPE=error MSG="NOTE: User defined min_travel_to_clean_z is set below 1.5mm - Warning possible bed damage may occur!"
        {% endif %}
        G0 Z{clean_vars.min_travel_to_clean_z|float} F3600
      {% endif %}

    {% else %}
      RESPOND TYPE=error MSG="NOTE: User defined min_travel_to_clean_z at a too low value! System override! Travelling at Z10.0"
      G0 Z10 F3600
    {% endif %}

  {% elif clean_vars.min_travel_to_clean_z|float <= 0.6 %}
    RESPOND TYPE=error MSG="NOTE: User defined min_travel_to_clean_z at a too low value! System override! Travelling at Z10.0"
    G0 Z10 F3600
  {% endif %}


